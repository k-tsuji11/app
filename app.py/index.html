<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payroll RPG: Money Leveler</title>
    
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Outfit:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #0a0a0f;
            --card-bg: #16161e;
            --gold: #facc15;
            --exp-bar: #22c55e;
            --text: #e2e8f0;
        }

        body {
            font-family: 'Outfit', 'DotGothic16', sans-serif;
            background: var(--bg);
            color: var(--text);
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .game-container {
            width: 100%;
            max-width: 450px;
            background: var(--card-bg);
            border: 4px solid #27272a;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
        }

        /* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰ */
        .player-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 15px;
        }

        .rank-icon {
            font-size: 2.5rem;
            background: #2d2d39;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            border: 2px solid var(--gold);
        }

        .level-badge {
            background: var(--gold);
            color: black;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
        }

        /* å…¥åŠ›ã‚¨ãƒªã‚¢ */
        .quest-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        label { font-size: 0.75rem; color: #94a3b8; display: block; margin-bottom: 5px; }
        input {
            width: 100%;
            background: #0f172a;
            border: 1px solid #334155;
            color: var(--gold);
            padding: 12px;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1.1rem;
        }

        /* è¨ˆç®—çµæœ */
        .result-screen {
            text-align: center;
            border-top: 2px dashed #334155;
            padding-top: 20px;
        }

        .gold-display {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--gold);
            text-shadow: 0 0 10px rgba(250, 204, 21, 0.3);
        }

        .exp-container {
            height: 10px;
            background: #1f2937;
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        #exp-fill {
            height: 100%;
            background: var(--exp-bar);
            width: 0%;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .item-drop {
            font-size: 0.9rem;
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            border: 1px solid #334155;
        }

        .title-text { color: var(--gold); font-family: 'DotGothic16'; }
    </style>
</head>
<body>

<div class="game-container">
    <div class="player-info">
        <div class="rank-icon" id="rank-emoji">ğŸ‘¨â€ğŸ’»</div>
        <div>
            <div style="display: flex; align-items: center; gap: 10px;">
                <span id="rank-name" class="title-text">è¦‹ç¿’ã„åŠ´åƒè€…</span>
                <span class="level-badge">Lv.<span id="level-val">1</span></span>
            </div>
            <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 4px;" id="title-desc">å†’é™ºã®å§‹ã¾ã‚Šã </div>
        </div>
    </div>

    <div class="quest-inputs">
        <div style="grid-column: span 2;">
            <label>BASE ATK (æ™‚çµ¦)</label>
            <input type="number" id="wage" value="1200" py-input="calculate">
        </div>
        <div>
            <label>QUEST TIME (å¹³æ™‚)</label>
            <input type="number" id="hours" value="160" py-input="calculate">
        </div>
        <div>
            <label>BURST TIME (æ®‹æ¥­)</label>
            <input type="number" id="overtime" value="0" py-input="calculate">
        </div>
    </div>

    <div class="result-screen">
        <label>TOTAL GOLD (æ‰‹å–ã‚Šé¡)</label>
        <div class="gold-display">G <span id="net-pay-val">0</span></div>
        
        <div class="exp-container">
            <div id="exp-fill"></div>
        </div>
        <div style="font-size: 0.7rem; color: #64748b;">NEXT LEVEL: <span id="next-exp">0</span> G</div>

        <div class="item-drop" id="loot-box">
            <div style="color: #94a3b8; font-size: 0.7rem; margin-bottom: 5px;">å…¥æ‰‹å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ </div>
            <span id="loot-item" style="font-weight: bold;">...è¨ˆç®—ä¸­</span>
        </div>
    </div>
</div>

<script type="py">
from pyscript import window
import math

def calculate(event=None):
    doc = window.document
    
    try:
        wage = float(doc.getElementById("wage").value or 0)
        hours = float(doc.getElementById("hours").value or 0)
        overtime = float(doc.getElementById("overtime").value or 0)
        
        # åŸºæœ¬è¨ˆç®—
        gross = (wage * hours) + (wage * 1.25 * overtime)
        net = gross * 0.8  # 20%æ§é™¤
        
        # 1. ãƒ¬ãƒ™ãƒ«ã‚·ã‚¹ãƒ†ãƒ  (1ä¸‡å††ã”ã¨ã«Lv1ä¸ŠãŒã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸)
        level = math.floor(net / 10000) + 1
        next_goal = (level * 10000)
        exp_percent = (net % 10000) / 10000 * 100
        
        # 2. ãƒ©ãƒ³ã‚¯ãƒ»ç§°å·ã‚·ã‚¹ãƒ†ãƒ 
        rank_name = "ä¸€èˆ¬å¸‚æ°‘"
        emoji = "ğŸ‘¨â€ğŸ’»"
        desc = "å®‰å®šã—ãŸåŠ´åƒã«å¾“äº‹ã—ã¦ã„ã‚‹"
        
        if net >= 300000:
            rank_name, emoji, desc = "ã‚®ãƒ«ãƒ‰ãƒã‚¹ã‚¿ãƒ¼", "ğŸ‘‘", "ä¼èª¬ã®ç¨¼ãæ‰‹"
        elif net >= 200000:
            rank_name, emoji, desc = "ç†Ÿç·´å†’é™ºè€…", "âš”ï¸", "ç¾å ´ã®ä¸»åŠ›çš„å­˜åœ¨"
        elif overtime > 40:
            rank_name, emoji, desc = "ç‹‚æˆ¦å£« (ãƒãƒ¼ã‚µãƒ¼ã‚«ãƒ¼)", "ğŸ”¥", "å‘½ã‚’å‰Šã£ã¦ç¨¼ã„ã§ã„ã‚‹"
        elif net < 50000:
            rank_name, emoji, desc = "æ‘äººA", "ğŸŒ¾", "ã®ã‚“ã³ã‚Šè‡ªçµ¦è‡ªè¶³"

        # 3. å…¥æ‰‹å¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ  (æ‰‹å–ã‚Šé¡ã§è²·ãˆã‚‹ã‚‚ã®)
        items = [
            (200000, "é«˜ç´šãƒ›ãƒ†ãƒ«ã®ã‚¹ã‚¤ãƒ¼ãƒˆ1æ³Š"),
            (100000, "æœ€æ–°ã®ã‚²ãƒ¼ãƒ æ©Ÿä¸€å¼"),
            (50000, "è±ªè¯ãªå›ã‚‰ãªã„å¯¿å¸"),
            (10000, "ã¡ã‚‡ã£ã¨ã„ã„ç„¼è‚‰"),
            (3000, "è´…æ²¢ãªãƒ©ãƒ³ãƒã‚»ãƒƒãƒˆ"),
            (500, "ã‚³ãƒ³ãƒ“ãƒ‹ã®ãƒ—ãƒè´…æ²¢ã‚¹ã‚¤ãƒ¼ãƒ„"),
            (0, "æ¸©ã‹ã„éº¦èŒ¶")
        ]
        loot = next(item[1] for item in items if net >= item[0])

        # è¡¨ç¤ºæ›´æ–°
        doc.getElementById("net-pay-val").innerText = f"{int(net):,}"
        doc.getElementById("level-val").innerText = str(level)
        doc.getElementById("exp-fill").style.width = f"{exp_percent}%"
        doc.getElementById("next-exp").innerText = f"{int(next_goal):,}"
        doc.getElementById("rank-name").innerText = rank_name
        doc.getElementById("rank-emoji").innerText = emoji
        doc.getElementById("title-desc").innerText = desc
        doc.getElementById("loot-item").innerText = f"ğŸ {loot}"
        
    except Exception:
        pass

calculate()
</script>

</body>
</html>